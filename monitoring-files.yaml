namespace: polkadot

metrics-dashboard:
  raw: true
  contents: |
    {
      "__inputs": [
        {
          "name": "DS_PROMETHEUS",
          "label": "Prometheus",
          "description": "",
          "type": "datasource",
          "pluginId": "prometheus",
          "pluginName": "Prometheus"
        }
      ],
      "__requires": [
        {
          "type": "panel",
          "id": "gauge",
          "name": "Gauge",
          "version": ""
        },
        {
          "type": "grafana",
          "id": "grafana",
          "name": "Grafana",
          "version": "7.0.1"
        },
        {
          "type": "panel",
          "id": "graph",
          "name": "Graph",
          "version": ""
        },
        {
          "type": "datasource",
          "id": "prometheus",
          "name": "Prometheus",
          "version": "1.0.0"
        },
        {
          "type": "panel",
          "id": "stat",
          "name": "Stat",
          "version": ""
        }
      ],
      "annotations": {
        "list": [
          {
            "$$hashKey": "object:263",
            "builtIn": 1,
            "datasource": "-- Grafana --",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "limit": 100,
            "name": "Annotations & Alerts",
            "showIn": 0,
            "type": "dashboard"
          }
        ]
      },
      "description": "Polkadot network node metrics",
      "editable": true,
      "gnetId": 12425,
      "graphTooltip": 0,
      "id": null,
      "links": [],
      "panels": [
        {
          "cacheTimeout": null,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {},
              "links": [
                {
                  "title": "",
                  "url": ""
                }
              ],
              "mappings": [
                {
                  "id": 0,
                  "op": "=",
                  "text": "Stuck",
                  "type": 1,
                  "value": "1492283"
                }
              ],
              "nullValueMode": "connected",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "rgb(222, 101, 171)",
                    "value": null
                  }
                ]
              },
              "unit": "locale"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 6,
            "w": 14,
            "x": 0,
            "y": 0
          },
          "id": 6,
          "links": [],
          "options": {
            "colorMode": "background",
            "graphMode": "area",
            "justifyMode": "center",
            "orientation": "vertical",
            "reduceOptions": {
              "calcs": [
                "last"
              ],
              "values": false
            }
          },
          "pluginVersion": "7.0.1",
          "targets": [
            {
              "expr": "polkadot_block_height",
              "interval": "",
              "legendFormat": "{{status}}",
              "refId": "B"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Height of the chain",
          "type": "stat"
        },
        {
          "cacheTimeout": null,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {},
              "mappings": [
                {
                  "id": 0,
                  "op": "=",
                  "text": "N/A",
                  "type": 1,
                  "value": "null"
                }
              ],
              "nullValueMode": "connected",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "semi-dark-blue",
                    "value": null
                  }
                ]
              },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 6,
            "w": 10,
            "x": 14,
            "y": 0
          },
          "id": 8,
          "links": [],
          "options": {
            "colorMode": "background",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "vertical",
            "reduceOptions": {
              "calcs": [
                "last"
              ],
              "values": false
            }
          },
          "pluginVersion": "7.0.1",
          "targets": [
            {
              "expr": "polkadot_network_per_sec_bytes",
              "legendFormat": "{{direction}}",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Networking bytes per second",
          "type": "stat"
        },
        {
          "aliasColors": {},
          "bars": false,
          "cacheTimeout": null,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 6
          },
          "hiddenSeries": false,
          "id": 4,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "hideEmpty": false,
            "hideZero": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pluginVersion": "6.7.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "polkadot_memory_usage_bytes",
              "instant": false,
              "intervalFactor": 1,
              "legendFormat": "Memory usage",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Node memory usage",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:342",
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:343",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 6
          },
          "hiddenSeries": false,
          "id": 2,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": true,
          "pluginVersion": "6.6.1",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "polkadot_cpu_usage_percentage",
              "instant": false,
              "legendFormat": "Node CPU Usage Percentage",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Node CPU usage",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "percent",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "description": "",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 14
          },
          "hiddenSeries": false,
          "id": 30,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pluginVersion": "6.7.3",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "rate(polkadot_tasks_polling_duration_bucket[5m])",
              "interval": "",
              "legendFormat": "{{task_name}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Tasks rate",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:2314",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:2315",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 14
          },
          "hiddenSeries": false,
          "id": 14,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pluginVersion": "6.7.1",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "rate(polkadot_tasks_polling_started_total[1m]) - rate(polkadot_tasks_polling_duration_count[1m])",
              "interval": "",
              "legendFormat": "{{task_name}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Running Tasks",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:956",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:957",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "description": "",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 22
          },
          "hiddenSeries": false,
          "id": 10,
          "legend": {
            "alignAsTable": false,
            "avg": true,
            "current": true,
            "max": true,
            "min": true,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "polkadot_sub_libp2p_peers_count",
              "instant": false,
              "interval": "",
              "legendFormat": "Peers count",
              "refId": "A"
            },
            {
              "expr": "polkadot_sub_libp2p_peerset_num_discovered",
              "interval": "",
              "legendFormat": "Discovered peers",
              "refId": "C"
            },
            {
              "expr": "polkadot_sub_libp2p_peerset_num_requested",
              "interval": "",
              "legendFormat": "Requested peers",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Peers connected, discovered, and requested",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:1204",
              "decimals": null,
              "format": "none",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:1205",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 22
          },
          "hiddenSeries": false,
          "id": 32,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "polkadot_sync_peers",
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Connected peers",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {},
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 5
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 30
          },
          "id": 22,
          "options": {
            "orientation": "auto",
            "reduceOptions": {
              "calcs": [
                "last"
              ],
              "values": false
            },
            "showThresholdLabels": false,
            "showThresholdMarkers": true
          },
          "pluginVersion": "7.0.1",
          "targets": [
            {
              "expr": "polkadot_load_avg",
              "interval": "",
              "legendFormat": "{{over}}",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Load Avg",
          "type": "gauge"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 30
          },
          "hiddenSeries": false,
          "id": 20,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "polkadot_netstat_tcp",
              "interval": "",
              "legendFormat": "{{status}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Netstat",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 38
          },
          "hiddenSeries": false,
          "id": 26,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "polkadot_state_db_cache_bytes",
              "interval": "",
              "legendFormat": "{{subtype}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "State Cache DB",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:1532",
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:1533",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 38
          },
          "hiddenSeries": false,
          "id": 18,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "rate(polkadot_finality_grandpa_communication_gossip_validator_messages[5m])",
              "interval": "",
              "legendFormat": "{{message}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "GRANDPA Validator Messages",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:312",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:313",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 46
          },
          "hiddenSeries": false,
          "id": 24,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "polkadot_state_cache_bytes",
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "State Cache",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:1295",
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:1296",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 46
          },
          "hiddenSeries": false,
          "id": 16,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "polkadot_sync_queued_blocks",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Queued Blocks (sync)",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {},
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 54
          },
          "id": 12,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "values": false
            }
          },
          "pluginVersion": "7.0.1",
          "targets": [
            {
              "expr": "polkadot_ready_transactions_number",
              "legendFormat": "Number of transactions in the ready queue",
              "refId": "A"
            }
          ],
          "timeFrom": null,
          "timeShift": null,
          "title": "Number of transactions in the ready queue",
          "type": "stat"
        },
        {
          "alert": {
            "alertRuleTags": {},
            "conditions": [
              {
                "evaluator": {
                  "params": [
                    6
                  ],
                  "type": "gt"
                },
                "operator": {
                  "type": "and"
                },
                "query": {
                  "params": [
                    "A",
                    "5m",
                    "now"
                  ]
                },
                "reducer": {
                  "params": [],
                  "type": "last"
                },
                "type": "query"
              }
            ],
            "executionErrorState": "alerting",
            "for": "5m",
            "frequency": "1m",
            "handler": 1,
            "name": "Number of Leaves alert",
            "noDataState": "no_data",
            "notifications": []
          },
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "${DS_PROMETHEUS}",
          "fieldConfig": {
            "defaults": {
              "custom": {}
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 54
          },
          "hiddenSeries": false,
          "id": 28,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "dataLinks": []
          },
          "percentage": false,
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "polkadot_number_leaves",
              "interval": "",
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": [
            {
              "colorMode": "critical",
              "fill": true,
              "line": true,
              "op": "gt",
              "value": 6
            }
          ],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Number of Leaves",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "$$hashKey": "object:1848",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "$$hashKey": "object:1849",
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": "10s",
      "schemaVersion": 25,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": []
      },
      "time": {
        "from": "now-6h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ]
      },
      "timezone": "",
      "title": "My Polkadot Metrics",
      "uid": "twYeaxRMz",
      "version": 10
    }

polkadot-prometheus-rules:
  raw: true
  contents: |
    {
      "groups": [
        {
          "name": "Node Alerts",
          "rules": [
            {
              "alert": "HostHighCpuLoad",
              "expr": "100 - (avg by(instance) (rate(node_cpu_seconds_total{mode=\"idle\"}[2m])) * 100) > 80",
              "for": "0m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "summary": "Host high CPU load (instance {{ $labels.instance }})",
                "description": "CPU load is > 80%\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"
              }
            },
            {
              "alert": "HostCpuStealNoisyNeighbor",
              "expr": "avg by(instance) (rate(node_cpu_seconds_total{job!=\"kubernetes-service-endpoints\",mode=\"steal\"}[5m])) * 100 > 10",
              "for": "0m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "summary": "Host CPU steal noisy neighbor (instance {{ $labels.instance }})",
                "description": "CPU steal is > 10%. A noisy neighbor is killing VM performances or a spot instance may be out of credit.\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"
              }
            },
            {
              "alert": "HostOutOfMemory",
              "expr": "node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes * 100 < 10",
              "for": "2m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "summary": "Host out of memory (instance {{ $labels.instance }})",
                "description": "Node memory is filling up (< 10% left)\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"
              }
            },
            {
              "alert": "HostMemoryUnderMemoryPressure",
              "expr": "rate(node_vmstat_pgmajfault[1m]) > 1000",
              "for": "2m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "summary": "Host memory under memory pressure (instance {{ $labels.instance }})",
                "description": "The node is under heavy memory pressure. High rate of major page faults\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"
              }
            },
            {
              "alert": "HostOutOfDiskSpace",
              "expr": "(node_filesystem_avail_bytes * 100) / node_filesystem_size_bytes < 10 and ON (instance, device, mountpoint) node_filesystem_readonly == 0",
              "for": "2m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "summary": "Host out of disk space (instance {{ $labels.instance }})",
                "description": "Disk is almost full (< 10% left)\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"
              }
            }
          ]
        },
        {
          "name": "HD alerts",
          "rules": [
            {
              "alert": "InstanceDown",
              "expr": "up == 0",
              "for": "2m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "summary": "Instance [{{ $labels.instance }}] down",
                "description": "[{{ $labels.instance }}] of job [{{ $labels.job }}] has been down for more than 1 minute."
              }
            },
            {
              "alert": "LostSync Polkadot",
              "expr": "polkadot_sync_peers < 5",
              "for": "2m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "summary": "Instance [{{ $labels.instance }}] sync peers < 5",
                "description": "[{{ $labels.instance }}] of job [{{ $labels.job }}] has been down for more than 1 minute."
              }
            },
            {
              "alert": "LostSync",
              "expr": "substrate_sync_peers < 5",
              "for": "2m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "summary": "Instance [{{ $labels.instance }}] sync peers < 5",
                "description": "[{{ $labels.instance }}] of job [{{ $labels.job }}] has been down for more than 1 minute."
              }
            }
          ]
        },
        {
          "name": "polkadot.rules",
          "rules": [
            {
              "alert": "BlockProductionSlow",
              "annotations": {
                "message": "Best block on instance {{ $labels.instance }} increases by less than 1 per minute for more than 3 minutes."
              },
              "expr": "increase(polkadot_block_height{status=\"best\"}[1m]) < 1",
              "for": "3m",
              "labels": {
                "severity": "warning"
              }
            },
            {
              "alert": "BlockProductionSlow",
              "annotations": {
                "message": "Best block on instance {{ $labels.instance }} increases by less than 1 per minute for more than 10 minutes."
              },
              "expr": "increase(polkadot_block_height{status=\"best\"}[1m]) < 1",
              "for": "10m",
              "labels": {
                "severity": "critical"
              }
            },
            {
              "alert": "BlockFinalizationSlow",
              "expr": "increase(polkadot_block_height{status=\"finalized\"}[1m]) < 1",
              "for": "3m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "Finalized block on instance {{ $labels.instance }} increases by less than 1 per minute for more than 3 minutes."
              }
            },
            {
              "alert": "BlockFinalizationSlow",
              "expr": "increase(polkadot_block_height{status=\"finalized\"}[1m]) < 1",
              "for": "10m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "message": "Finalized block on instance {{ $labels.instance }} increases by less than 1 per minute for more than 10 minutes."
              }
            },
            {
              "alert": "BlockFinalizationLaggingBehind",
              "expr": "(polkadot_block_height_number{status=\"best\"} - ignoring(status) polkadot_block_height_number{status=\"finalized\"}) > 10",
              "for": "8m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "message": "Block finalization on instance {{ $labels.instance }} is behind block production by {{ $value }} for more than 8 minutes."
              }
            },
            {
              "alert": "TransactionQueueSizeIncreasing",
              "expr": "increase(polkadot_sub_txpool_validations_scheduled[5m]) - increase(polkadot_sub_txpool_validations_finished[5m]) > 0",
              "for": "10m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "The transaction pool size on node {{ $labels.instance }} has been monotonically increasing for more than 10 minutes."
              }
            },
            {
              "alert": "TransactionQueueSizeIncreasing",
              "expr": "increase(polkadot_sub_txpool_validations_scheduled[5m]) - increase(polkadot_sub_txpool_validations_finished[5m]) > 0",
              "for": "30m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "message": "The transaction pool size on node {{ $labels.instance }} has been monotonically increasing for more than 30 minutes."
              }
            },
            {
              "alert": "TransactionQueueSizeHigh",
              "expr": "polkadot_sub_txpool_validations_scheduled - polkadot_sub_txpool_validations_finished > 10000",
              "for": "5m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "message": "The transaction pool size on node {{ $labels.instance }} has been above 10_000 for more than 5 minutes."
              }
            },
            {
              "alert": "NumberOfPeersLow",
              "expr": "polkadot_sub_libp2p_peers_count < 3",
              "for": "3m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "The node {{ $labels.instance }} has less than 3 peers for more than 3 minutes"
              }
            },
            {
              "alert": "NumberOfPeersLow",
              "expr": "polkadot_sub_libp2p_peers_count < 3",
              "for": "15m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "message": "The node {{ $labels.instance }} has less than 3 peers for more than 15 minutes"
              }
            },
            {
              "alert": "NumberOfFileDescriptorsHigh",
              "expr": "node_filefd_allocated{domain=~\"kusama|polkadot\"} > 10000",
              "for": "3m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "The node {{ $labels.instance }} has more than 10_000 file descriptors allocated for more than 3 minutes"
              }
            },
            {
              "alert": "ContinuousTaskEnded",
              "expr": "(polkadot_tasks_spawned_total{task_name != \"basic-authorship-proposer\"} == 1) - on(instance, task_name) group_left() (polkadot_tasks_ended_total == 1)",
              "for": "5m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "Continuous task {{ $labels.task_name }} on node {{ $labels.instance }} ended unexpectedly."
              }
            },
            {
              "alert": "AuthorityDiscoveryDiscoveryFailureHigh",
              "expr": "polkadot_authority_discovery_handle_value_found_event_failure / ignoring(name) polkadot_authority_discovery_dht_event_received{name=\"value_found\"} > 0.5",
              "for": "2h",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "Authority discovery on node {{ $labels.instance }} fails to process more than 50 % of the values found on the DHT for more than 2 hours."
              }
            },
            {
              "alert": "UnboundedChannelPersistentlyLarge",
              "expr": "( (polkadot_unbounded_channel_len{action = \"send\"} - ignoring(action) polkadot_unbounded_channel_len{action = \"received\"}) or on(instance) polkadot_unbounded_channel_len{action = \"send\"} ) >= 200",
              "for": "5m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "Channel {{ $labels.entity }} on node {{ $labels.instance }} contains more than 200 items for more than 5 minutes. Node might be frozen."
              }
            },
            {
              "alert": "UnboundedChannelVeryLarge",
              "expr": "( (polkadot_unbounded_channel_len{action = \"send\"} - ignoring(action) polkadot_unbounded_channel_len{action = \"received\"}) or on(instance) polkadot_unbounded_channel_len{action = \"send\"} ) > 15000",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "Channel {{ $labels.entity }} on node {{ $labels.instance }} contains more than 15000 items."
              }
            }
          ]
        }
      ]
    }

substrate-prometheus-rules:
  raw: true
  contents: |
    {
      "groups": [
        {
          "name": "validators.rules",
          "rules": [
            {
              "alert": "BlockProductionSlow",
              "annotations": {
                "message": "Best block on instance {{ $labels.instance }} increases by less than 1 per minute for more than 3 minutes."
              },
              "expr": "increase(substrate_block_height{status=\"best\"}[1m]) < 1",
              "for": "3m",
              "labels": {
                "severity": "warning"
              }
            },
            {
              "alert": "BlockProductionSlow",
              "annotations": {
                "message": "Best block on instance {{ $labels.instance }} increases by less than 1 per minute for more than 10 minutes."
              },
              "expr": "increase(substrate_block_height{status=\"best\"}[1m]) < 1",
              "for": "10m",
              "labels": {
                "severity": "critical"
              }
            },
            {
              "alert": "BlockFinalizationSlow",
              "expr": "increase(substrate_block_height{status=\"finalized\"}[1m]) < 1",
              "for": "3m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "Finalized block on instance {{ $labels.instance }} increases by less than 1 per minute for more than 3 minutes."
              }
            },
            {
              "alert": "BlockFinalizationSlow",
              "expr": "increase(substrate_block_height{status=\"finalized\"}[1m]) < 1",
              "for": "10m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "message": "Finalized block on instance {{ $labels.instance }} increases by less than 1 per minute for more than 10 minutes."
              }
            },
            {
              "alert": "BlockFinalizationLaggingBehind",
              "expr": "(substrate_block_height_number{status=\"best\"} - ignoring(status) substrate_block_height_number{status=\"finalized\"}) > 10",
              "for": "8m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "message": "Block finalization on instance {{ $labels.instance }} is behind block production by {{ $value }} for more than 8 minutes."
              }
            },
            {
              "alert": "TransactionQueueSizeIncreasing",
              "expr": "increase(substrate_sub_txpool_validations_scheduled[5m]) - increase(substrate_sub_txpool_validations_finished[5m]) > 0",
              "for": "10m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "The transaction pool size on node {{ $labels.instance }} has been monotonically increasing for more than 10 minutes."
              }
            },
            {
              "alert": "TransactionQueueSizeIncreasing",
              "expr": "increase(substrate_sub_txpool_validations_scheduled[5m]) - increase(substrate_sub_txpool_validations_finished[5m]) > 0",
              "for": "30m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "message": "The transaction pool size on node {{ $labels.instance }} has been monotonically increasing for more than 30 minutes."
              }
            },
            {
              "alert": "TransactionQueueSizeHigh",
              "expr": "substrate_sub_txpool_validations_scheduled - substrate_sub_txpool_validations_finished > 10000",
              "for": "5m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "message": "The transaction pool size on node {{ $labels.instance }} has been above 10_000 for more than 5 minutes."
              }
            },
            {
              "alert": "NumberOfPeersLow",
              "expr": "substrate_sub_libp2p_peers_count < 3",
              "for": "3m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "The node {{ $labels.instance }} has less than 3 peers for more than 3 minutes"
              }
            },
            {
              "alert": "NumberOfPeersLow",
              "expr": "substrate_sub_libp2p_peers_count < 3",
              "for": "15m",
              "labels": {
                "severity": "critical"
              },
              "annotations": {
                "message": "The node {{ $labels.instance }} has less than 3 peers for more than 15 minutes"
              }
            },
            {
              "alert": "NumberOfFileDescriptorsHigh",
              "expr": "node_filefd_allocated{domain=~\"kusama|polkadot\"} > 10000",
              "for": "3m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "The node {{ $labels.instance }} has more than 10_000 file descriptors allocated for more than 3 minutes"
              }
            },
            {
              "alert": "AuthorityDiscoveryDiscoveryFailureHigh",
              "expr": "substrate_authority_discovery_handle_value_found_event_failure / ignoring(name) substrate_authority_discovery_dht_event_received{name=\"value_found\"} > 0.5",
              "for": "2h",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "Authority discovery on node {{ $labels.instance }} fails to process more than 50 % of the values found on the DHT for more than 2 hours."
              }
            },
            {
              "alert": "UnboundedChannelPersistentlyLarge",
              "expr": "( (substrate_unbounded_channel_len{action = \"send\"} - ignoring(action) substrate_unbounded_channel_len{action = \"received\"}) or on(instance) substrate_unbounded_channel_len{action = \"send\"} ) >= 200",
              "for": "5m",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "Channel {{ $labels.entity }} on node {{ $labels.instance }} contains more than 200 items for more than 5 minutes. Node might be frozen."
              }
            },
            {
              "alert": "UnboundedChannelVeryLarge",
              "expr": "( (substrate_unbounded_channel_len{action = \"send\"} - ignoring(action) substrate_unbounded_channel_len{action = \"received\"}) or on(instance) substrate_unbounded_channel_len{action = \"send\"} ) > 15000",
              "labels": {
                "severity": "warning"
              },
              "annotations": {
                "message": "Channel {{ $labels.entity }} on node {{ $labels.instance }} contains more than 15000 items."
              }
            }
          ]
        }
      ]
    }

